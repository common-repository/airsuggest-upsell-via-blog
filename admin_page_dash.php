<?phpfunction airsub_option_page(){    ob_start(); ?>    <style type="text/css">        .successMsg {            padding: 20px;            color: #3c763d;            background-color: #dff0d8;            border-color: #d6e9c6;        }        .errorMsg {            padding: 20px;            color: #a94442;            background-color: #f2dede;            border-color: #ebccd1;        }        .air-disp-n {            display: none        }        .air-disp-b {            display: block        }    </style>    <div class="wrap">        <div class="edit-pic-details">            <h1>Air Suggest Up Sell Settings</h1>            <?php            settings_fields('airsub_setting_group');            ?>        </div>    </div>    <div class="wrap">        <input type="text" name="air-suggest-api-key" class="air-suggest-api-key" style="width: 340px"               placeholder="Enter Your Api Key" value=""/>        <input type="hidden" id="airsub-nonce" name="airs-nonce"               value="<?php echo wp_create_nonce('save_airsub_details'); ?>">        <a href="javascript:void(0)" class="button-primary" onclick="airsubcheckApiKey()">Submit</a>        <p class="successMsg air-disp-n"></p>        <p class="errorMsg air-disp-n"></p>    </div>    <script type="text/javascript">        var $ = jQuery;        var AirSubAdminAPIURL = 'https://www.airsuggest.com/api/';        var shopDomain = window.location.hostname;        var formData = new FormData();        formData.append('shopDomain', shopDomain);        formData.append('security', $.trim($('#airsub-nonce').val()));        $.ajax({            type: 'POST',            url: AirSubAdminAPIURL + 'check_api_blogger',            data: formData,            dataType: 'json',            contentType: false,            cache: false,            processData: false,            beforeSend: function () {            },            success: function (response) {                if (response.code == 200) {                    if (response.api_setup == '1') {                        $('.air-suggest-api-key').val(response.apiKey);                        $('.successMsg').removeClass('air-disp-b');                        $('.successMsg').addClass('air-disp-n');                        $('.errorMsg').removeClass('air-disp-b');                        $('.errorMsg').addClass('air-disp-n');                    }                } else {                    $('.errorMsg').text(response.message);                    $('.successMsg').removeClass('air-disp-b');                    $('.successMsg').addClass('air-disp-n');                    $('.errorMsg').removeClass('air-disp-n');                    $('.errorMsg').addClass('air-disp-b');                }            }        });        function airsubcheckApiKey() {            if ($.trim($('.air-suggest-api-key').val())) {                var formData = new FormData();                formData.append('api_key', $.trim($('.air-suggest-api-key').val()));                formData.append('shopDomain', shopDomain);                $.ajax({                    type: 'POST',                    url: AirSubAdminAPIURL + 'verify_api_blogger',                    data: formData,                    dataType: 'json',                    contentType: false,                    cache: false,                    processData: false,                    beforeSend: function () {                    },                    success: function (response) {                        if (response.code == 200) {                            $('.successMsg').text('API Key has been verified successfully for your shop.');                            $('.successMsg').removeClass('air-disp-n');                            $('.successMsg').addClass('air-disp-b');                            $('.errorMsg').removeClass('air-disp-b');                            $('.errorMsg').addClass('air-disp-n');                        } else {                            $('.errorMsg').text(response.message);                            $('.successMsg').removeClass('air-disp-b');                            $('.successMsg').addClass('air-disp-n');                            $('.errorMsg').removeClass('air-disp-n');                            $('.errorMsg').addClass('air-disp-b');                        }                    }                });            } else {                $('.errorMsg').text('Enter API Key');                $('.successMsg').removeClass('air-disp-b');                $('.successMsg').addClass('air-disp-n');                $('.errorMsg').removeClass('air-disp-n');                $('.errorMsg').addClass('air-disp-b');            }        }    </script>    <?php    echo ob_get_clean();}function register_airsub_menu_page(){    add_menu_page('Air Suggest Up Sell', 'Air Suggest Up Sell', 'manage_options', 'air-suggest-up-sell-dashboard', 'airsub_option_page');}add_action('admin_menu', 'register_airsub_menu_page');function airsub_register_settings(){    register_setting('airsub_setting_group', 'airsub_setting');}add_action('admin_init', 'airsub_register_settings');function airsub_load_scripts(){    wp_enqueue_style('airsub_style', plugin_dir_url(__FILE__) . 'css/airsub-style.css', array(), time(), false);    wp_enqueue_script('airsub_script_jq_carrousel', plugin_dir_url(__FILE__) . 'js/jquery-accessible-carrousel-aria.js', array('jquery'), time(), true);    wp_enqueue_script('airsub_script_slider', plugin_dir_url(__FILE__) . 'js/slider.js', array('jquery'), time(), true);    wp_enqueue_script('airsub_script', plugin_dir_url(__FILE__) . 'js/airsub-main.js', array('jquery'), time(), true);}add_action('wp_enqueue_scripts', 'airsub_load_scripts', 99);function AirSuggestUpSellOnBlog(){    $AirsubContent = '<section class="fixedsec fixfooter fixFoot" id="airsub-fix-footer"><div class="wraper">     <div id="clientsection">     <div class="btnnav airsubtags0">    	 <ul>         </ul>         <a class="air-remove" id="footer-air-remove" href="javascript:void(0)" onclick="removeairwindow(1)">X</a>     </div>      <div class="clientList" id="airsub_products">     	<ul>        	        </ul>     </div>     </div></div></section>';    return $AirsubContent;}function AirSuggestUpSellOnBlogUnFixed(){    $AirsubContent = '<section class="nofixedsec nofixfooter fixFoot" id="airsub-fix-footer-content"><div class="wraper">     <div id="clientsection">     <div class="btnnav airsubtags0">    	 <ul>         </ul>         <a class="air-remove" id="content-air-remove" href="javascript:void(0)" onclick="removeairwindow(2)">X</a>     </div>      <div class="clientList" id="airsub_products">     	<ul>        	        </ul>     </div>     </div></div></section>';    return $AirsubContent;}function AirSuggestReward(){    $currentURL = (isset($_SERVER['HTTPS']) && $_SERVER['HTTPS'] === 'on' ? "https" : "http") . "://$_SERVER[HTTP_HOST]$_SERVER[REQUEST_URI]";    $AirRewardContent = '<button id="airsShare" title="Share">Share</button><div class="Airspopup" id="airsharepopup" role="alert">  <div class="Airspopup-container">    <a href="javascript:void(0)" class="Airspopup-close Airsimg-replace">Close</a>    <div class="header_index">    <div class="cus-container_index">    <div class="header-inr_index">        <div class="header-left_index">            <ul>                <li>                    <input class="my-input_index" id="air-reward-search-product" type="text" placeholder="Search for brand(example - Macy\'s , Nike, etc.)">                </li>                <li class="text-right">                     <a href="javascript:void(0)" onclick="airsubSearchProduct(\'air-reward-search-product\',0)" class="my-btn_index btn-pink_index">                    <span class="icon_index">                        <img src="'.plugin_dir_url(__FILE__).'images/Union4.png" alt="search">                    </span>                    <span class="icon_index_search">Search</span>                </a>            </li>            </ul>        </div>           </div>    </div></div>  <div class="main_index">    <div class="cus-container_index">        <!--<div class="sub-header_index">        <ul>            <li>                <a href="#" class="my-btn_index btn-pink_index">                    <span class="icon_index">                        <img src="'.plugin_dir_url(__FILE__).'images/Group16.png" alt="setting">                    </span>                </a>            </li>            <li class="width-20_index">                <input class="my-input_index" type="text" placeholder="Tags (ex: android, iPhone, web, ui, ux)">            </li>            <li class="width-20_index">                <input class="my-input_index" type="text" placeholder="Colors (ex: enter hex code or select)">            </li>            <li class="width-20_index">                <select class="my-select_index">                    <option>Mode With</option>                </select>            </li>            <li class="width-20_index">                <select class="my-select_index">                    <option>Download</option>                </select>            </li>        </ul>    </div>-->    <div class="share_earn_reward_index">        <div class="share_container_index">            <h2>Share and earn reward</h2>            <div class="social_icons">                <ul>                    <!--<li><a href=""><img src="'.plugin_dir_url(__FILE__).'images/icon_5.png" alt="icon"></a></li>                    <li><a href=""><img src="'.plugin_dir_url(__FILE__).'images/icon_2.png" alt="icon"></a></li>                    <li><a href=""><img src="'.plugin_dir_url(__FILE__).'images/icon_3.png" alt="icon"></a></li>                    <li><a href=""><img src="'.plugin_dir_url(__FILE__).'images/icon_4.png" alt="icon"></a></li>-->                    <li style="margin: auto"><a href="https://www.facebook.com/sharer/sharer.php?u='.$currentURL.'" target="_blank"><img src="'.plugin_dir_url(__FILE__).'images/f-share.png" width="100" alt="icon"></a></li>                    <!--<li><a href=""><img src="'.plugin_dir_url(__FILE__).'images/icon_6.png" alt="icon"></a></li>                    <li><a href=""><img src="'.plugin_dir_url(__FILE__).'images/icon_7.png" alt="icon"></a></li>                    <li><a href=""><img src="'.plugin_dir_url(__FILE__).'images/icon_8.png" alt="icon"></a></li>                    <li><a href=""><img src="'.plugin_dir_url(__FILE__).'images/icon_9.png" alt="icon"></a></li>                    <li><a href=""><img src="'.plugin_dir_url(__FILE__).'images/icon_10.png" alt="icon"></a></li>                    <li><a href=""><img src="'.plugin_dir_url(__FILE__).'images/icon_11.png" alt="icon"></a></li>                    <li><a href=""><img src="'.plugin_dir_url(__FILE__).'images/icon_12.png" alt="icon"></a></li>-->                </ul>            </div>            <!--<div class="sub-header_index">                    <ul>                        <li>                            <a href="#" class="my-btn_index btn-pink_index">                                <span class="icon_index">                                    <img src="'.plugin_dir_url(__FILE__).'images/Group16.png" alt="setting">                                </span>                            </a>                        </li>                        <li class="width-20_index">                            <input class="my-input_index" type="text" placeholder="Tags (ex: android, iPhone, web, ui, ux)">                        </li>                    </ul>                </div>                    <div class="sub-header_index">        <ul>            <li>                <a href="#" class="my-btn_index btn-pink_index">                    <span class="icon_index">                        <img src="'.plugin_dir_url(__FILE__).'images/Group16.png" alt="setting">                    </span>                </a>            </li>            <li>                <input class="my-input_index" type="text" placeholder="Tags (ex: android, iPhone, web, ui, ux)">            </li>        </ul>    </div>-->    <h2>Best in Class deals</h2>        </div>    </div>    <div class="bt_containe_indexr">        <div class="btnnav_index">         <ul>         </ul>     </div>    </div>    <div class="pro-sec index_scnd_index">        <div class="pro-sec-inr_index">    </div>    </div></div></div>  </div> </div>';    return $AirRewardContent;}function AirSuggestUpsellAfterPostTitle($content){    if (is_single() && !is_admin() && 'post' == get_post_type() ) {        $custom_title = AirSuggestUpSellOnBlog();        $content = $custom_title . $content;        return $content;    } else {        return $content;    }}function AirSuggestSidebar($content){    if (is_single() && !is_admin() && 'post' == get_post_type() ) {        $mycontent = air_reviews_to_the_sidebar();        $content = $mycontent.$content;        return $content;    } else {        return $content;    }}function AirSuggestRewardOnPost($content){    if (is_single() && !is_admin() && 'post' == get_post_type() ) {        $custom_title = AirSuggestReward();        $content = $custom_title . $content;        return $content;    } else {        return $content;    }}function AirSuggestFloatingUpsell(){    $id = get_the_ID();    $post_categories = wp_get_post_categories( $id );    $cats = '';    $i = 0;    foreach($post_categories as $c){        $cat = get_category( $c );        if($i == 0){            $cats .= $cat->name;        }else{            $cats .= '|||'.$cat->name;        }        $i++;    }    $AirsubFloating = '<div id="page">    <input type="hidden" id="airsub-post-cats" value="' . $cats . '" />    <input type="hidden" id="airsub-plug-path" value="' . plugin_dir_url(__FILE__) . '" />    <input type="hidden" id="airsub-nonce" name="airsub-nonce" value="'. wp_create_nonce( 'save_airs_details' ).'">    <div class="carrousel relative mb2">        <div class="carrousel__container mod--hidden mb1" data-carrousel-btn-previous-img="' . plugin_dir_url(__FILE__) . '/images/arrow-right.png"             data-carrousel-btn-next-img="' . plugin_dir_url(__FILE__) . '/images/arrow-left.png" data-carrousel-btn-previous-text="previous "             data-carrousel-btn-next-text=" next" data-carrousel-prefix-classes="news"             data-carrousel-span-text="Contenu" data-carrousel-span-text-class="invisible"             data-carrousel-transition="slide" data-carrousel-hx="h3">            <div class="carrousel__content">                <div class="wraper wrapermain">                    <div id="tabs1">                        <ul class="tabnav">                            <li><a href="javascript:void(0)" onclick="AirsubopenTab(\'#BoughTogther\')">Bough Togther</a></li>                            <li><a href="javascript:void(0)" onclick="AirsubopenTab(\'#Cheaperoption\')">Cheaper option</a></li>                            <li><a href="javascript:void(0)" onclick="AirsubopenTab(\'#BestValue\')">Best Value </a></li>                        </ul>                        <div class="btnnav airsubtags1">                            <ul>                            </ul>                            <label class="switch"><input type="checkbox" id="btnPassport1" value="NO"                                                         name="btnPassport1">                                <div class="slider round "><!--ADDED HTML --><span class="off">ON</span><span                                        class="on">OFF</span><!--END--></div>                            </label>                        </div>                        <div class="filtersarea filtersareamain">                            <div class="searcharea">                                <input name="" type="button" class="sarchbtn"><input name="" id="airsub-search" onkeyup="airsubSearchProduct(\'airsub-search\',\'0\')" type="text"                                                                                     placeholder="Search by title, name, catagories">                            </div>                            <div class="filtersarealtmain">                                <div class="center filter">                                    <select name="sources" id="sources" class="custom-select sources"                                            placeholder="Short by Newest">                                        <option value="Short by: A to Z">Short by: A to Z</option>                                        <option value="Short by: Z to A">Short by: Z to A</option>                                        <option value="Short by: Low to High">Short by: Low to High</option>                                        <option value="Short by: High to Low">Short by: High to Low</option>                                        <option value="Short by: Avg Rating">Short by: Avg Rating</option>                                    </select>                                </div>                                <div class="center items">                                    <select name="sources" id="sources1" class="custom-select sources"                                            placeholder="Items">                                        <option value="10 Items">10 Items</option>                                        <option value="15 Items">15 Items</option>                                        <option value="20 Items">20 Items</option>                                        <option value="25 Items">25 Items</option>                                        <option value="30 Items">30 Items</option>                                    </select>                                </div>                            </div>                        </div>                        <div id="BoughTogther" class="airs-tabs airs-d-block">                            <div class="productRow productRow0">                                <ul>                                                                    </ul>                            </div>                            <a href="https://www.airsuggest.com" target="_blank" class="powered">Powered By: Air Suggest</a>                            <button onclick="AirsubFunction1()" class="showhidebtn"><img src="' . plugin_dir_url(__FILE__) . '/images/showhidebtn.png"                                                                                     width="19" height="20"></button>                            <div style="display:none" id="myDIV1">                                <div class="contentsection">                                    <div class="wraper">                                        <div class="productRow productRow1">                                            <ul>                                                                                            </ul>                                        </div>                                    </div>                                </div>                            </div>                        </div>                        <div id="Cheaperoption" class="airs-tabs airs-d-none">                            <div class="productRow productRow2">                                <ul>                                </ul>                            </div>                            <a href="https://www.airsuggest.com" target="_blank" class="powered">Powered By: Air Suggest</a>                            <button onclick="AirsubFunction2()" class="showhidebtn"><img src="' . plugin_dir_url(__FILE__) . '/images/showhidebtn.png"                                                                                     width="19" height="20"></button>                            <div style="display:none" id="myDIV2">                                <div class="contentsection">                                    <div class="wraper">                                        <div class="productRow productRow3">                                            <ul>                                                                                            </ul>                                        </div>                                    </div>                                </div>                            </div>                        </div>                        <div id="BestValue" class="airs-tabs airs-d-none">                            <div class="productRow productRow4">                                <ul>                                                                    </ul>                            </div>                            <a href="https://www.airsuggest.com" target="_blank" class="powered">Powered By: Air Suggest</a>                            <button onclick="AirsubFunction3()" class="showhidebtn"><img src="' . plugin_dir_url(__FILE__) . '/images/showhidebtn.png"                                                                                     width="19" height="20"></button>                            <div style="display:none" id="myDIV3">                                <div class="contentsection">                                    <div class="wraper">                                        <div class="productRow productRow5">                                            <ul>                                                                                            </ul>                                        </div>                                    </div>                                </div>                            </div>                        </div>                    </div>                </div>            </div>            <div class="carrousel__content">                <div class="wraper wrapermain">                    <div id="tabs2">                        <ul class="tabnav">                            <li><a href="javascript:void(0)" onclick="AirsubopenTab(\'#BoughTogther2\')">Bough Togther</a></li>                            <li><a href="javascript:void(0)" onclick="AirsubopenTab(\'#Cheaperoption2\')">Cheaper option</a></li>                            <li><a href="javascript:void(0)" onclick="AirsubopenTab(\'#BestValue2\')">Best Value </a></li>                        </ul>                        <div class="btnnav airsubtags2">                            <ul>                            </ul>                            <label class="switch"><input type="checkbox" id="btnPassport2" value="No"                                                         name="btnPassport2">                                <div class="slider round "><!--ADDED HTML --><span class="off">ON</span><span                                        class="on">OFF</span><!--END--></div>                            </label>                        </div>                        <div class="filtersarea filtersareamain">                            <div class="searcharea">                                <input name="" type="button" class="sarchbtn"><input name="" id="airsub-search1" onkeyup="airsubSearchProduct(\'airsub-search1\',\'1\')" type="text"                                                                                     placeholder="Search by title, name, catagories">                            </div>                            <div class="filtersarealtmain">                                <div class="center filter">                                    <select name="sources" id="sources3" class="custom-select sources"                                            placeholder="Short by Newest">                                        <option value="Short by: A to Z">Short by: A to Z</option>                                        <option value="Short by: Z to A">Short by: Z to A</option>                                        <option value="Short by: Low to High">Short by: Low to High</option>                                        <option value="Short by: High to Low">Short by: High to Low</option>                                        <option value="Short by: Avg Rating">Short by: Avg Rating</option>                                    </select>                                </div>                                <div class="center items">                                    <select name="sources" id="sources4" class="custom-select sources"                                            placeholder="Items">                                        <option value="10 Items">10 Items</option>                                        <option value="15 Items">15 Items</option>                                        <option value="20 Items">20 Items</option>                                        <option value="25 Items">25 Items</option>                                        <option value="30 Items">30 Items</option>                                    </select>                                </div>                            </div>                        </div>                        <div id="BoughTogther2" class="airs-tabs airs-d-block">                            <div class="productRow productRow6">                                <ul>                                </ul>                            </div>                            <a href="https://www.airsuggest.com" target="_blank" class="powered">Powered By: Air Suggest</a>                            <button onclick="AirsubFunction4()" class="showhidebtn"><img src="' . plugin_dir_url(__FILE__) . '/images/showhidebtn.png"                                                                                     width="19" height="20"></button>                            <div style="display:none" id="myDIV4">                                <div class="contentsection">                                    <div class="wraper">                                        <div class="productRow productRow7">                                            <ul>                                            </ul>                                        </div>                                    </div>                                </div>                            </div>                        </div>                        <div id="Cheaperoption2" class="airs-tabs airs-d-none">                            <div class="productRow productRow8">                                <ul>                                </ul>                            </div>                            <a href="https://www.airsuggest.com" target="_blank" class="powered">Powered By: Air Suggest</a>                            <button onclick="AirsubFunction5()" class="showhidebtn"><img src="' . plugin_dir_url(__FILE__) . '/images/showhidebtn.png"                                                                                     width="19" height="20"></button>                            <div style="display:none" id="myDIV5">                                <div class="contentsection">                                    <div class="wraper">                                        <div class="productRow productRow9">                                            <ul>                                            </ul>                                        </div>                                    </div>                                </div>                            </div>                        </div>                        <div id="BestValue2" class="airs-tabs airs-d-none">                            <div class="productRow productRow10">                                <ul>                                </ul>                            </div>                            <a href="https://www.airsuggest.com" target="_blank" class="powered">Powered By: Air Suggest</a>                            <button onclick="AirsubFunction6()" class="showhidebtn"><img src="' . plugin_dir_url(__FILE__) . '/images/showhidebtn.png"                                                                                     width="19" height="20"></button>                            <div style="display:none" id="myDIV6">                                <div class="contentsection">                                    <div class="wraper">                                        <div class="productRow productRow11">                                            <ul>                                            </ul>                                        </div>                                    </div>                                </div>                            </div>                        </div>                    </div>                </div>            </div>        </div>    </div></div>';    return $AirsubFloating;}function AirSuggestUpsellAfterPostSecondPara($content){    if (is_single() && !is_admin() && 'post' == get_post_type() ) {//        $custom_title = AirSuggestFloatingUpsell();        $custom_title = AirSuggestUpSellOnBlogUnFixed();        return airsub_insert_after_paragraph($custom_title, 2, $content);    } else {        return $content;    }}function airsub_insert_after_paragraph($insertion, $paragraph_id, $content){    $closing_p = '</p>';    $paragraphs = explode($closing_p, $content);    foreach ($paragraphs as $index => $paragraph) {        if (trim($paragraph)) {            $paragraphs[$index] .= $closing_p;        }        if ($paragraph_id == $index + 1) {            $paragraphs[$index] .= $insertion;        }    }    return implode('', $paragraphs);}function air_reviews_to_the_sidebar(){    $myairsidebar = '<div id="airsub_sidebar" class="pro_tabs_scnd_index">	<div class="tab_container_index mb_sp_vw">		<div class="btnnav_index">        <a class="air-remove" id="sidebar-air-remove" href="javascript:void(0)" onclick="removeairwindow(3)">X</a>    	 <ul>        	         </ul>     </div>     <div class="steps_row_index">     	     </div>	</div></div>';    return $myairsidebar;}add_filter('the_content', 'AirSuggestUpsellAfterPostTitle');add_filter('the_content', 'AirSuggestUpsellAfterPostSecondPara');add_filter('the_content', 'AirSuggestSidebar');add_filter('the_content', 'AirSuggestRewardOnPost');add_shortcode('air-suggest-upsell', 'AirSuggestUpSellOnBlog');?>